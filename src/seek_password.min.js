function hex_password(e,t){var n=sha512.hmac(t,e),s=sha512.hmac("hello",n),a=sha512.hmac("world",n),r=s.split(""),o=a.split("");console.assert(o.length===r.length,"sha512长度错误！");for(var l=0;l<r.length;++l)if(isNaN(r[l])){"whenthecatisawaythemicewillplay666".search(o[l])>-1&&(r[l]=r[l].toUpperCase())}return r.join("")}function seek_password(e,t,n,s){var a="abcdefghijklmnopqrstuvwxyz".split(""),r="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),o="0123456789".split(""),l="~*-+()!@#$^&".split(""),c=o;parseInt(s)>-2&&(c=c.concat(a),1==parseInt(n)&&(c=c.concat(l)),1==parseInt(s)&&(c=c.concat(r)));for(var i=0;i<=e.length-t;++i){var p=e.slice(i,i+parseInt(t)).split(""),u=0,h=p.map(function(e){return u=(u+e.charCodeAt())%c.length}).map(function(e){return c[e]}),d=[!1,!1,!1,!1];if(h.forEach(function(e){d[0]=d[0]||a.includes(e),d[1]=d[1]||r.includes(e),d[2]=d[2]||o.includes(e),d[3]=d[3]||l.includes(e)}),-1==parseInt(s)&&(d[1]=!0),-2==parseInt(s)&&(d[0]=!0,d[1]=!0),-1==parseInt(n)&&(d[3]=!0),!d.includes(!1))return h.join("")}return""}function get_select_option(e){var t=document.getElementById(e),n=t.selectedIndex;return[t.options[n].value,t.options[n].text]}function generate_password(){var e=document.getElementById("pwd").value,t=document.getElementById("key").value,n=get_select_option("rule_of_punctuation"),s=get_select_option("rule_of_letter"),a=get_select_option("pwd_length");if(e&&t){var r=hex_password(e,t);console.assert(128===r.length,"hash长度不是128位！");return seek_password(r,a[0],n[0],s[0])}}